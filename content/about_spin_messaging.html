<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>About SPIN Messaging | SPIN Framework</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="http://www.spinframework.org/favicon.gif" type="image/x-icon" />
    <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node.css%3Fg.css" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults.css%3Fg.css" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system.css%3Fg.css" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus.css%3Fg.css" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user.css%3Fg.css" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/cck/theme/content-module.css%3Fg.css" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/ckeditor/ckeditor.css%3Fg.css" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/dhtml_menu/dhtml_menu.css%3Fg.css" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/lightbox2/css/lightbox.css%3Fg.css" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/nice_menus/nice_menus.css%3Fg.css" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/nice_menus/nice_menus_default.css%3Fg.css" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/plainscape/css/960/reset.css%3Fg.css" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/plainscape/css/960/960.css%3Fg.css" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/plainscape/css/style.css%3Fg.css" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/plainscape/css/admin.css%3Fg.css" />
    <!--[if lt IE 7]>
    <link type="text/css" rel="stylesheet" media="all" href="sites/all/themes/plainscape/css/ie.css" />
    <![endif]-->
    <script type="text/javascript" src="../misc/jquery.js%3Fg"></script>
<script type="text/javascript" src="../misc/drupal.js%3Fg"></script>
<script type="text/javascript" src="../sites/all/modules/dhtml_menu/dhtml_menu.js%3Fg"></script>
<script type="text/javascript" src="../sites/all/modules/lightbox2/js/lightbox.js%3Fg"></script>
<script type="text/javascript" src="../sites/all/modules/nice_menus/nice_menus.js%3Fg"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, { "basePath": "/", "dhtmlMenu": { "slide": "slide", "siblings": 0, "relativity": 0, "children": 0, "clone": 0, "doubleclick": 0 }, "lightbox2": { "rtl": 0, "file_path": "/(\\w\\w/)sites/default/files", "default_image": "/sites/all/modules/lightbox2/images/brokenimage.jpg", "border_size": 10, "font_color": "000", "box_color": "fff", "top_position": "", "overlay_opacity": 0.8, "overlay_color": "000", "disable_close_click": true, "resize_sequence": 0, "resize_speed": 400, "fade_in_speed": 400, "slide_down_speed": 600, "use_alt_layout": false, "disable_resize": false, "disable_zoom": false, "force_show_nav": false, "loop_items": false, "node_link_text": "View Image Details", "node_link_target": false, "image_count": "Image !current of !total", "video_count": "Video !current of !total", "page_count": "Page !current of !total", "lite_press_x_close": "press \x3ca href=\"#\" onclick=\"hideLightbox(); return FALSE;\"\x3e\x3ckbd\x3ex\x3c/kbd\x3e\x3c/a\x3e to close", "download_link_text": "", "enable_login": false, "enable_contact": false, "keys_close": "c x 27", "keys_previous": "p 37", "keys_next": "n 39", "keys_zoom": "z", "keys_play_pause": "32", "display_image_size": "", "image_node_sizes": "()", "trigger_lightbox_classes": "", "trigger_lightbox_group_classes": "", "trigger_slideshow_classes": "", "trigger_lightframe_classes": "", "trigger_lightframe_group_classes": "", "custom_class_handler": 0, "custom_trigger_classes": "", "disable_for_gallery_lists": true, "disable_for_acidfree_gallery_lists": true, "enable_acidfree_videos": true, "slideshow_interval": 5000, "slideshow_automatic_start": true, "slideshow_automatic_exit": true, "show_play_pause": true, "pause_on_next_click": false, "pause_on_previous_click": true, "loop_slides": false, "iframe_width": 600, "iframe_height": 400, "iframe_border": 1, "enable_video": false } });
//--><!]]>
</script>
  </head>
  <body>
    <div id="wrapper" class="container_12">
      <div id="header" class="grid_12">
        <div id="header-left" class="grid_8 alpha">
                      <a href="about.html" title="Go to Homepage"><img src="../images/logo_SPIN.jpg" alt="SPIN Framework" id="logo" /></a>
                                <h1 id="site-name"><a href="about.html" title="Go to Homepage">SPIN Framework</a></h1>
                                <div id="site-slogan">Networked Framework for Distributed Virtual Environments &amp; 3D Visualization</div>
                  </div><!-- #header-left -->
        <div id="header-right" class="grid_4 omega">
                  </div><!-- #header-right -->
        <div class="clear"></div>
      </div><!-- #header -->
      <div class="clear"></div>
      <div id="primary-nav" class="grid_12">
                  <ul class="links"><li class="menu-114 first"><a href="about.html" title="

	About

">Welcome</a></li>
<li class="menu-116"><a href="showcase.html" title="Showcase">Showcase</a></li>
<li class="menu-362"><a href="../downloads.html" title="

	Download

">Downloads</a></li>
<li class="menu-118 active-trail last"><a href="documentation.html" title="Documentation">Documentation</a></li>
</ul>              </div><!-- #primary-nav -->
      <div class="clear"></div>
      <div id="content-wrapper" class="grid_12">
        <div id="main" class="grid_8 alpha">
                                                                      <div id="node-15" class="node clear-block">
      <h2 class="title">About SPIN Messaging</h2>
    <div class="meta">
      </div>
  <div class="content">
    <p>
	The SPIN Framework is designed so multiple processes can share high-level 3D state over a network using <a href="http://opensoundcontrol.org/" target="_blank">OpenSoundControl</a> (OSC) messages. By default, all messages are sent from the server via UDP multicast on the address of 239.0.0.1. An INFO channel (port) is used to send notifications about available ports, where clients can listen or connect and send messages to the server.</p>
<p>
	Below is a table that summarizes the important networking channels used by SPIN. We will explain each of these in more detail below.</p>
<table align="center" border="1" cellpadding="3" cellspacing="0">
<tbody>
<tr>
<td align="center">
				<strong>channel</strong></td>
<td align="center">
				<strong>RX proto</strong></td>
<td align="center">
				<strong>RX addr </strong></td>
<td align="center">
				<strong>RX port </strong></td>
<td align="center">
				<strong>TX proto </strong></td>
<td align="center">
				<strong>TX addr</strong></td>
<td align="center">
				<strong>TX port </strong></td>
</tr>
<tr>
<td align="center">
				<strong>INFO</strong></td>
<td align="center">
				multicast UDP</td>
<td align="center">
				239.0.0.1</td>
<td align="center">
				54320</td>
<td align="center">
				multicast UDP</td>
<td align="center">
				239.0.0.1</td>
<td align="center">
				54320</td>
</tr>
<tr>
<td align="center">
				<strong>SERVER</strong></td>
<td align="center">
				unicast UDP</td>
<td align="center">
				[serverIP]</td>
<td align="center">
				54324</td>
<td align="center">
				multicast UDP</td>
<td align="center">
				239.0.0.1</td>
<td align="center">
				54323</td>
</tr>
<tr>
<td align="center">
				<strong>SECURE</strong></td>
<td align="center">
				TCP</td>
<td align="center">
				[serverIP]</td>
<td align="center">
				54322</td>
<td align="center">
				TCP</td>
<td align="center" colspan="2" rowspan="1">
				[client subscibes]</td>
</tr>
<tr>
<td align="center">
				<strong>CLIENT</strong></td>
<td align="center">
				multicast UDP</td>
<td align="center">
				239.0.0.1</td>
<td align="center">
				54323</td>
<td align="center">
				unicast UDP</td>
<td align="center">
				[serverIP]</td>
<td align="center">
				54324</td>
</tr>
<tr>
<td align="center">
				<strong>TIMECODE</strong></td>
<td align="center" colspan="2">
				same as client RX addr</td>
<td align="center">
				54321</td>
<td align="center" colspan="2">
				same as client TX addr</td>
<td align="center">
				54321</td>
</tr>
</tbody>
</table>
<p class="rtecenter">
	<small>NOTE: These are default settings, and can be overridden using command-line arguments or environment variables.</small></p>
<p>
	Using the above table, we can imagine a basic setup consisting of one <em>spinserver</em> and one <em>spinviewer</em> (a type of client). Any time the state changes on the server, a multicast message is emitted by ther sercer on port 54323. The viewer listens on this port and updates it&#39;s internal representation so that the change is drawn in the next frame. The client may want to send some messages to the server. For instance, a spinviewer allows a user to pick and move an object using the mouse. In this case, messages are sent to the server on port 54324; the server state will be updates, and the resulting change is again multicast on port 54323, and will be displayed.</p>
<p>
	&nbsp;</p>
<hr />
<h2>
	SPIN Message Protocol</h2>
<p>
	In general, all messaging conforms to a particular protocol:</p>
<blockquote><p>
		<strong>/SPIN/&lt;sceneID&gt;/&lt;nodeID&gt; method &lt;var_args&gt;</strong></p>
</blockquote>
<p>
	All OSC messages are contained within the /SPIN namespace, and may control a scene element or a particular node within a scene. For example, a message to <tt>/SPIN/<span style="font-family: Arial,Verdana,sans-serif;">someScene</span></tt> will control a scene with id &quot;someScene&quot; at the scene level, allowing you to create/delete nodes, clear/refresh the scene, etc. If the selector is more specific, for example <tt>/SPIN/someScene/someModel</tt>, the intention is to send messages to a particular node, and not the scene in general. Wildcards are acceptable in the selector, so <tt>/SPIN/*/shape*</tt> would target all nodes that start with &quot;shape&quot; on all servers on the network.</p>
<p>
	<strong>For a full reference of all messages, see the <a href="osc_protocol.html">osc protocol page</a></strong></p>
<p>
	&nbsp;</p>
<hr />
<h2>
	The INFO channel</h2>
<p>
	To facilitate the network binding procedure, the server periodically multicasts it&#39;s information on the <b>INFO channel</b>, notifying potential clients of it&#39;s existence, and providing the ports to which they must send messages. The server&#39;s info message looks like this:</p>
<pre class="rteindent1">
/SPIN/__server__ sceneID addr rxUDPport rxTCPport txAddr txPort syncPort</pre><p>
	In the case of our defaults described in the table above, a real example might look like this:</p>
<pre class="rteindent1">
/SPIN/__server__ default 192.168.1.100 54324 54322 224.0.0.1 54323 54321
</pre><p>
	&nbsp;</p>
<hr />
<h2>
	Client INFO (and <em>UserNodes</em>)</h2>
<p>
	An &quot;official&quot; SPIN client process that communicates with a server should create a UserNode in the scene with a UserID as an identifier (typically, the computer&#39;s hostname is used as the UserID).</p>
<p>
	The client is then required to periodically send the &quot;ping&quot; message to the UserNode it created in order &nbsp;to assert &nbsp;the client&#39;s continued presence. &nbsp;If a client suddenly disappears, the server will see an interruption in the stream of &nbsp;&quot;ping&quot; messages to that UserNode and will thus clean up unnecessary state (i.e. delete the UserNode and its subgraph).</p>
<p>
	A client&#39;s &quot;ping&quot; message to the UserNode it created should be sent at least once every 20 seconds; &nbsp;the message should &nbsp;be structured like this:</p>
<pre class="rteindent1">
/SPIN/sceneID UserNodeID ping
</pre><p>
	&nbsp;</p>
<p>
	<strong>IMPORTANT</strong>: Any UserNode created on the server (and any attached child nodes) will be automatically removed by the server if an info message is not received within a regular interval (eg, within 60 seconds).</p>
<p>
	&nbsp;</p>
<hr />
<h2>
	Secure TCP Channel</h2>
<p>
	The server listens to messages on UDP for non-critical control data, while important state messages should be sent to the server via TCP. Any one may send messages to the TCP channel, but it should be understood that this is a one-way connection; resulting changes to the scene state will be sent out via UDP multicast as usual.</p>
<p>
	If a client wants to receive important state from the server via TCP, a subscription is required. The client must send a &quot;subscribe&quot; message to the server&#39;s TCP port, in the following form:</p>
<pre class="rteindent1">
/SPIN/sceneID subscribe UserID clientAddr clientTCPport</pre><p>
	The server will then form a unicast TCP connection to the client&#39;s specified address, and send any requested state to that port. However, only the following TCP queries are currently supported:</p>
<table align="center" border="1" cellpadding="4" cellspacing="0" style="width: 90%;">
<thead>
<tr>
<th scope="col">
				Message</th>
<th scope="col">
				Result</th>
</tr>
</thead>
<tbody>
<tr>
<td nowrap="nowrap">
				/SPIN/&lt;sceneID&gt; refresh</td>
<td>
				SPIN will send the entire scene in bundles to the TCP receiver</td>
</tr>
<tr>
<td nowrap="nowrap">
				/SPIN/&lt;sceneID&gt; getState &lt;nodeID&gt;</td>
<td>
				SPIN will send the state of a node to the TCP receiver</td>
</tr>
</tbody>
</table>
<p>
	&nbsp;</p>
<hr />
<h2>
	Timecode and Synchronization</h2>
<p>
	A timecode is sent in a separate multicast OSC channel, allowing clients to manage their own animations while maintaining sync with the server:</p>
<pre class="rteindent1">
/SPIN/&lt;sceneID&gt; sync &lt;elapsed-time-in-milliseconds&gt;
</pre><p>
	&nbsp;</p>
<hr />
<h2>
	Example</h2>
<p>
	To summarize, when SPIN launches, it periodically sends an info message on the INFO channel:</p>
<pre class="rteindent1">
/SPIN/__server__ sceneID rxAddr rxUDPport rxTCPport txAddr txPort syncPort
</pre><p>
	Clients can just listen on UDP port txAddr:txPort for scene updates, or they can connect (via unicast to rxAddr:rxUDPport) and send server-level messages. Example:</p>
<pre class="rteindent1">
/SPIN/sceneID debug
/SPIN/sceneID createNode &lt;nodeType&gt; &lt;nodeID&gt;
/SPIN/sceneID deleteNode &lt;nodeID&gt;
/SPIN/sceneID load &lt;scenefile.xml&gt;
/SPIN/sceneID save &lt;scenefile.xml&gt;
/SPIN/sceneID clear
</pre><p>
	Once a particular node is created on the server, messages can be sent to it as follows:</p>
<pre class="rteindent1">
/SPIN/sceneID/nodeID setTranslation 1 2 3
/SPIN/sceneID/nodeID setOrientation 1 2 3
/SPIN/sceneID/nodeID setParent &lt;parentID&gt;
</pre><p>
	All clients listening on the server&#39;s txAddr:txPort, will be notified on these updates, and can update themselves accordingly.</p>
  </div>
  <div class="meta node-links">
    
      </div>
  </div>
                  </div>
                  <div id="sidebar" class="grid_3 omega">
            <div id="block-nice_menus-3" class="block block-nice_menus">
  <h2><span class="nice-menu-show-title">Documentation</span></h2>

  <div class="content">
    <ul class="nice-menu nice-menu-left" id="nice-menu-3"><li id="menu-354" class="menu-path-node-17"><a href="overview.html" title="Overview" id="dhtml_menu-354">Overview</a></li>
<li id="menu-540" class="menu-path-node-40"><a href="../wiki/quick_start_osx.html" title="Quick Start Guide for OSX" id="dhtml_menu-540">Quick start for OSX</a></li>
<li id="menu-542" class="menu-path-node-41"><a href="../wiki/quick_start_ubuntu.html" title="Quick Start Guide for Ubuntu Linux" id="dhtml_menu-542">Quick start for Ubuntu</a></li>
<li id="menu-352" class="menu-path-node-15"><a href="about_spin_messaging.html" title="About SPIN Messaging" id="dhtml_menu-352" class="active">About SPIN Messaging</a></li>
<li id="menu-350" class="menu-path-node-13"><a href="pdsheefa.html" title="

	pdsheefa

" id="dhtml_menu-350">About [pdsheefa]</a></li>
</ul>
  </div>
</div>
<div id="block-nice_menus-2" class="block block-nice_menus">
  <h2><span class="nice-menu-show-title">Other Links</span></h2>

  <div class="content">
    <ul class="nice-menu nice-menu-left" id="nice-menu-2"><li id="menu-545" class="menu-path-code.sat.qc.ca-spinframework"><a href="http://code.sat.qc.ca/spinframework" title="

	http://code.sat.qc.ca/spinframework

" id="dhtml_menu-545">Developer Site</a></li>
<li id="menu-300" class="menu-path-node-6"><a href="credits.html" title="Credits" id="dhtml_menu-300">Credits</a></li>
<li id="menu-299" class="menu-path-contact"><a href="../contact.html" title="

" id="dhtml_menu-299">Contact</a></li>

</ul>
  </div>
</div>
<div id="block-search-0" class="block block-search">
  <h2>Search</h2>

  <div class="content">
    <form action="about_spin_messaging.html"  accept-charset="UTF-8" method="post" id="search-block-form">
<div><div class="container-inline">
  <div class="form-item" id="edit-search-block-form-1-wrapper">
 <label for="edit-search-block-form-1">Search this site: </label>
 <input type="text" maxlength="128" name="search_block_form" id="edit-search-block-form-1" size="15" value="" title="Enter the terms you wish to search for." class="form-text" />
</div>
<input type="submit" name="op" id="edit-submit" value="Search"  class="form-submit" />
<input type="hidden" name="form_build_id" id="form-XuCIDdFDPWrGMBYFv7RWNvg7fIYfhmMpruxCQMQ49yA" value="form-XuCIDdFDPWrGMBYFv7RWNvg7fIYfhmMpruxCQMQ49yA"  />
<input type="hidden" name="form_id" id="edit-search-block-form" value="search_block_form"  />
</div>

</div></form>
  </div>
</div>
          </div>
                <div class="clear"></div>
      </div><!-- #content-wrapper -->
      <div class="clear"></div>
      <div id="footer-top" class="grid_12">
              </div>
      <div id="footer" class="grid_12">
                  <p><p>

	SPIN Framework<br />

	Copyright &copy; 2011, Mike Wozniewski, Zack Settel</p>

</p>
                              </div><!-- #footer -->
      <div class="clear"></div>
    </div><!-- #wrapper -->
      </body>
</html>